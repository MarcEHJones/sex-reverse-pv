---
title: "10-xxx"
output: html_document
---


~From script 2~

5. Plots to explore the data.

Head width at the back relative to SVL:
log(SVL) vs log(HWqu) 

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HWqu), 
                colour =  Genotype, fill = Genotype, shape =  Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  #geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(2, 4.5)+
  xlim(3.5, 6) +
  ylab("log(HWqu) (mm)") +
  xlab("LOG(SVL) (mm)")


```


Head width at the back relative to head length:
log(HLroret) vs log(HWqu) 

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(HLroret), y = log(HWqu), 
                colour =  Genotype, fill = Genotype, shape =  Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  #geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(2, 4.5)+
  xlim(2.5, 4.5) +
  ylab("log(HWqu) (mm)") +
  xlab("log(HLroret) (mm)")


```

~From script 3~


Plots of log raw head dimensions against SVL.

SVL vs HLroret

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HLroret), 
                colour = Genotype, fill = Genotype, shape = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_shape_manual(values=c(23, 21, 22)) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(HLroret) (N)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-HLroret.png"))
```


SVL vs HLroqu

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HLroqu), 
                colour = Genotype, fill = Genotype, shape = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_shape_manual(values=c(23, 21, 22)) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(HLroqu) (N)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-HLroqu.png"))
```

SVL vs HWmt

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HWmt), 
                colour = Genotype, fill = Genotype, shape = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_shape_manual(values=c(23, 21, 22)) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(HWmt) (N)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-Hwqu.png"))
```


SVL vs HWqu

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HWqu), 
                colour = Genotype, fill = Genotype, shape = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_shape_manual(values=c(23, 21, 22)) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(HWqu) (N)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-Hwqu.png"))
```

SVL vs HDmt

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(HDmt), 
                colour = Genotype, fill = Genotype, shape = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_shape_manual(values=c(23, 21, 22)) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(HDmt) (N)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-HDmt.png"))
```

~From script 5~

Exploratory plots




This creates a plot of log(BF) vs log(Mass)

```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = Mass, y = BiteForce, 
                colour = Genotype, fill = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  #geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  #ylim(0, 5)+
  #xlim(4, 6) +
  ylab("log(Bite Force) (N)") +
  xlab("log(Mass) (g)")

#ggsave(here("figures/mass-bf.png"))
```


```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(Mass), y = log(BiteForce), 
                colour = Genotype, fill = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(1, 5)+
  xlim(1, 6) +
  ylab("log(Bite Force) (N)") +
  xlab("log(Mass) (g)")

#ggsave(here("figures/LOG-mass-bf.png"))
```


This creates a plot of log(SVL) vs log(Mass).


```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = log(SVL), y = log(Mass), 
                colour = Genotype, fill = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  geom_smooth(method = lm, se = TRUE, alpha = 0.2) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 5)+
  xlim(4, 5.5) +
  ylab("log(Mass) (g)") +
  xlab("log(SVL) (mm)")

#ggsave(here("figures/svl-mass.png"))
```



This code creates a plot of BF vs headlength (rostrum-tympanum).


```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = HLroqu, y = BiteForce, 
                colour = Genotype, fill = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 100)+
  xlim(10, 60) +
  ylab("Bite Force (N)") +
  xlab("Head length (mm)") +
  labs(tag = "B") +
  theme(plot.tag = element_text(size = 12, face = "bold"),
        axis.title = element_text(size = 12))

```


This code creates a plot of BF vs headlength (rostrum-tympanum).


```{r, message = FALSE}
# All individuals
ggplot(pog, aes(x = HLroret, y = BiteForce, 
                colour = Genotype, fill = Genotype)) +
  geom_point(alpha = 0.8, na.rm = TRUE) +
  scale_colour_manual(values = c("orange1", "red", "cornflowerblue")) +
  scale_fill_manual(values = c("orange1", "red", "cornflowerblue")) +
  theme_bw(base_size = 14) +
  #theme(legend.title = element_blank()) +
  ylim(0, 100)+
  xlim(10, 60) +
  ylab("Bite Force (N)") +
  xlab("Head length (mm)") +
  labs(tag = "B") +
  theme(plot.tag = element_text(size = 12, face = "bold"),
        axis.title = element_text(size = 12))

```

End of plots

Data summary table

Set up an empty output file
```{r}
output <- data.frame(array(dim = c(14, 20)))
names(output) <- c("response", "predictor", "df", 
                   "F_pred", "p_pred", 
                   "F_gen", "p_gen", 
                   "F_int", "p_int", 
                   "slope_ZZF", "slope_se_ZZF",
                   "slopediff_ZWF", "se_ZWF",
                   "t_ZWF", "p_ZWF",
                   "slopediff_ZZM", "se_ZZM",
                   "t_ZZM", "p_ZZM",
                   "adj.r2")

# Short function to help write output files
write_output <- function(model, response, predictor, n){
  
  x <- tidy(anova(model))
  y <- summary(model)
    
  output[n, "response"] <- response
  output[n, "predictor"] <- predictor
  output[n, "df"] <- x$df[4]
    output[n, "F_pred"] <- x$statistic[1]
    output[n, "p_pred"] <- x$p.value[1]
    output[n, "F_gen"] <- x$statistic[2]
    output[n, "p_gen"] <- x$p.value[2]
    output[n, "F_int"] <- x$statistic[3]
    output[n, "p_int"] <- x$p.value[3]
    output[n, "slope_ZZF"] <- y$coefficients[2]
    output[n, "slope_se_ZZF"] <- y$coefficients[8]
    output[n, "slopediff_ZWF"] <- y$coefficients[5]
    output[n, "se_ZWF"] <- y$coefficients[11]
    output[n, "t_ZWF"] <- y$coefficients[17]
    output[n, "p_ZWF"] <- y$coefficients[23]
    output[n, "slopediff_ZZM"] <- y$coefficients[6]
    output[n, "se_ZZM"] <- y$coefficients[12]
    output[n, "t_ZZM"] <- y$coefficients[18]
    output[n, "p_ZZM"] <- y$coefficients[24]
    output[n, "adj.r2"] <- y$adj.r.squared
    return(output)
}
```

